Add-type -assembly "Microsoft.Office.Interop.Outlook" | out-null


Function Get-Monday {
    Write-Host("
███╗   ███╗ ██████╗ ███╗   ██╗██████╗  █████╗ ██╗   ██╗
████╗ ████║██╔═══██╗████╗  ██║██╔══██╗██╔══██╗╚██╗ ██╔╝
██╔████╔██║██║   ██║██╔██╗ ██║██║  ██║███████║ ╚████╔╝ 
██║╚██╔╝██║██║   ██║██║╚██╗██║██║  ██║██╔══██║  ╚██╔╝  
██║ ╚═╝ ██║╚██████╔╝██║ ╚████║██████╔╝██║  ██║   ██║   
╚═╝     ╚═╝ ╚═════╝ ╚═╝  ╚═══╝╚═════╝ ╚═╝  ╚═╝   ╚═╝
")
}

Function Get-Tuesday {
    Write-Host("
████████╗██╗   ██╗███████╗███████╗██████╗  █████╗ ██╗   ██╗
╚══██╔══╝██║   ██║██╔════╝██╔════╝██╔══██╗██╔══██╗╚██╗ ██╔╝
   ██║   ██║   ██║█████╗  ███████╗██║  ██║███████║ ╚████╔╝ 
   ██║   ██║   ██║██╔══╝  ╚════██║██║  ██║██╔══██║  ╚██╔╝  
   ██║   ╚██████╔╝███████╗███████║██████╔╝██║  ██║   ██║   
   ╚═╝    ╚═════╝ ╚══════╝╚══════╝╚═════╝ ╚═╝  ╚═╝   ╚═╝       
")
}

Function Get-Wednesday {
    Write-Host("
██╗    ██╗███████╗██████╗ ███╗   ██╗███████╗███████╗██████╗  █████╗ ██╗   ██╗
██║    ██║██╔════╝██╔══██╗████╗  ██║██╔════╝██╔════╝██╔══██╗██╔══██╗╚██╗ ██╔╝
██║ █╗ ██║█████╗  ██║  ██║██╔██╗ ██║█████╗  ███████╗██║  ██║███████║ ╚████╔╝ 
██║███╗██║██╔══╝  ██║  ██║██║╚██╗██║██╔══╝  ╚════██║██║  ██║██╔══██║  ╚██╔╝  
╚███╔███╔╝███████╗██████╔╝██║ ╚████║███████╗███████║██████╔╝██║  ██║   ██║   
 ╚══╝╚══╝ ╚══════╝╚═════╝ ╚═╝  ╚═══╝╚══════╝╚══════╝╚═════╝ ╚═╝  ╚═╝   ╚═╝    
")
}

Function Get-Thursday {
    Write-Host("
████████╗██╗  ██╗██╗   ██╗██████╗ ███████╗██████╗  █████╗ ██╗   ██╗
╚══██╔══╝██║  ██║██║   ██║██╔══██╗██╔════╝██╔══██╗██╔══██╗╚██╗ ██╔╝
   ██║   ███████║██║   ██║██████╔╝███████╗██║  ██║███████║ ╚████╔╝ 
   ██║   ██╔══██║██║   ██║██╔══██╗╚════██║██║  ██║██╔══██║  ╚██╔╝  
   ██║   ██║  ██║╚██████╔╝██║  ██║███████║██████╔╝██║  ██║   ██║   
   ╚═╝   ╚═╝  ╚═╝ ╚═════╝ ╚═╝  ╚═╝╚══════╝╚═════╝ ╚═╝  ╚═╝   ╚═╝                            
")
}

Function Get-Friday {
    Write-Host("
███████╗██████╗ ██╗██████╗  █████╗ ██╗   ██╗
██╔════╝██╔══██╗██║██╔══██╗██╔══██╗╚██╗ ██╔╝
█████╗  ██████╔╝██║██║  ██║███████║ ╚████╔╝ 
██╔══╝  ██╔══██╗██║██║  ██║██╔══██║  ╚██╔╝  
██║     ██║  ██║██║██████╔╝██║  ██║   ██║   
╚═╝     ╚═╝  ╚═╝╚═╝╚═════╝ ╚═╝  ╚═╝   ╚═╝ 
")
}

Function Get-Saturday {
    Write-Host("
███████╗ █████╗ ████████╗██╗   ██╗██████╗ ██████╗  █████╗ ██╗   ██╗
██╔════╝██╔══██╗╚══██╔══╝██║   ██║██╔══██╗██╔══██╗██╔══██╗╚██╗ ██╔╝
███████╗███████║   ██║   ██║   ██║██████╔╝██║  ██║███████║ ╚████╔╝ 
╚════██║██╔══██║   ██║   ██║   ██║██╔══██╗██║  ██║██╔══██║  ╚██╔╝  
███████║██║  ██║   ██║   ╚██████╔╝██║  ██║██████╔╝██║  ██║   ██║   
╚══════╝╚═╝  ╚═╝   ╚═╝    ╚═════╝ ╚═╝  ╚═╝╚═════╝ ╚═╝  ╚═╝   ╚═╝    
")
}

Function Get-Sunday {
    Write-Host("
███████╗██╗   ██╗███╗   ██╗██████╗  █████╗ ██╗   ██╗
██╔════╝██║   ██║████╗  ██║██╔══██╗██╔══██╗╚██╗ ██╔╝
███████╗██║   ██║██╔██╗ ██║██║  ██║███████║ ╚████╔╝ 
╚════██║██║   ██║██║╚██╗██║██║  ██║██╔══██║  ╚██╔╝  
███████║╚██████╔╝██║ ╚████║██████╔╝██║  ██║   ██║   
╚══════╝ ╚═════╝ ╚═╝  ╚═══╝╚═════╝ ╚═╝  ╚═╝   ╚═╝   
")
}

Function Get-Header {
    Param (
        $Optional = 'Today'
    )

    Write-Host("
 ██████╗ █████╗ ██╗     ███████╗███╗   ██╗██████╗  █████╗ ██████╗ 
██╔════╝██╔══██╗██║     ██╔════╝████╗  ██║██╔══██╗██╔══██╗██╔══██╗
██║     ███████║██║     █████╗  ██╔██╗ ██║██║  ██║███████║██████╔╝
██║     ██╔══██║██║     ██╔══╝  ██║╚██╗██║██║  ██║██╔══██║██╔══██╗
╚██████╗██║  ██║███████╗███████╗██║ ╚████║██████╔╝██║  ██║██║  ██║
 ╚═════╝╚═╝  ╚═╝╚══════╝╚══════╝╚═╝  ╚═══╝╚═════╝ ╚═╝  ╚═╝╚═╝  ╚═╝
")<#
███████╗ ██████╗ ██████╗     ████████╗ ██████╗ ██████╗  █████╗ ██╗   ██╗   
██╔════╝██╔═══██╗██╔══██╗    ╚══██╔══╝██╔═══██╗██╔══██╗██╔══██╗╚██╗ ██╔╝██╗
█████╗  ██║   ██║██████╔╝       ██║   ██║   ██║██║  ██║███████║ ╚████╔╝ ╚═╝
██╔══╝  ██║   ██║██╔══██╗       ██║   ██║   ██║██║  ██║██╔══██║  ╚██╔╝  ██╗
██║     ╚██████╔╝██║  ██║       ██║   ╚██████╔╝██████╔╝██║  ██║   ██║   ╚═╝
╚═╝      ╚═════╝ ╚═╝  ╚═╝       ╚═╝    ╚═════╝ ╚═════╝ ╚═╝  ╚═╝   ╚═╝                                            
") -NoNewLine
#>
    # Business Logic for fetching the correct header
    if ($Optional -eq 'Today') {
        $DayToday = (Get-Date).DayOfWeek
        Switch ($DayToday) {
            'Monday'    {Get-Monday}
            'Tuesday'   {Get-Tuesday}
            'Wednesday' {Get-Wednesday}
            'Thursday'  {Get-Thursday}
            'Friday'    {Get-Friday}
            'Saturday'  {Get-Saturday}
            'Sunday'    {Get-Sunday}
        }
    }
    

}

Function Get-Calendar {
    Param (
        $Optional = 'Today'
    )

    Clear-Host
    $OutlookFolder = "Microsoft.Office.Interop.Outlook.OlDefaultFolders" -as [type]

    $Outlook = New-Object -ComObject Outlook.Application

    $Namespace = $Outlook.GetNameSpace("MAPI")

    $Folder = $Namespace.getDefaultFolder($OutlookFolder::olFolderCalendar)

    $DateToday = (Get-Date -Format "dd.MM.yyyy").ToString()
    #Subject, Start, Duration, Location
    
    $CalendarEvents = $Folder.Items | Select-Object -Property Subject, Start, Duration, Location | Sort-Object Start
    
    # Get the appropriate header
    Get-Header -Optional $Optional

    if ($Optional -eq 'All') {
        $CalendarEvents
    }

    if ($Optional -eq 'Today') {
        $Found = $False
        # Output todays activites
        foreach($Object in $CalendarEvents) {
            if (($Object.Start).ToString() -Match $DateToday) {
                $Object
                $Found = $True
            }
        }

        if ($Found -eq $False) {
            Write-Host ("You do not have anything planned for today")
        }
    }
}

Export-Modulemember -function Get-Calendar